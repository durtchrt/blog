<!DOCTYPE html>
<html ⚡>
  <head>
    <meta charset="utf-8">
<meta name="pinterest" content="nopin">
<meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
<meta name="theme-color" content="#263238">

<meta name="generator" content="Hugo 0.31-DEV" />

<link rel="apple-touch-icon" href="http://durtchrt.github.io/blog/images/logo.png">


<link rel="canonical" href="http://durtchrt.github.io/blog/english/spring.io/webflux/">



    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>

    
    <link href="https://fonts.googleapis.com/css?family=Lobster%7cLato:400,700" rel="stylesheet">
    
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
    <title>Spring WebFlux - durtchrt</title>
    
<meta name="description" content="Introduction 스프링 프레임워크, 스프링 Web MVC에 있는 웹프레임워크는 Servlet API와 Servlet 컨테이너를 만들기위한 용도였습니다. 반응형스택, 웹프레임워크, 스프링 웹플럭스는 5.0 버전 이후에 추가되었습니다. 완전한 논블럭킹, Reactive Streams 지원, 역압(back pressure) 그리고 Netty, Undertow, Servlet 3.1 이상 서버에서 동작합니다. 두 웹프레임워크들 spring-webmvc, spring-webflux 는 스프링 프레임워크에서 나란히 공존하며 모듈들은 옵션입니다. 어플리케이션은 하나 또는 둘 다 사용할 수 있습니다. e.g 스프링 MVC 컨트롤러와 리액티브 웹클라이언트 새로운 웹프레임워크가 왜 필요할까? 대답의 일부로 적은 스레드 갯수로 비동기를 다루고 논블럭킹 웹스택과 적은 하드웨어 자원으로 확장이 필요하다는 것이다.">

<meta property="og:title" content="Spring WebFlux - durtchrt">
<meta property="og:type" content="article">
<meta property="og:url" content="http://durtchrt.github.io/blog/english/spring.io/webflux/">
<meta property="og:image" content="http://durtchrt.github.io/blog/images/default.png">
<meta property="og:site_name" content="durtchrt">
<meta property="og:description" content="Introduction 스프링 프레임워크, 스프링 Web MVC에 있는 웹프레임워크는 Servlet API와 Servlet 컨테이너를 만들기위한 용도였습니다. 반응형스택, 웹프레임워크, 스프링 웹플럭스는 5.0 버전 이후에 추가되었습니다. 완전한 논블럭킹, Reactive Streams 지원, 역압(back pressure) 그리고 Netty, Undertow, Servlet 3.1 이상 서버에서 동작합니다. 두 웹프레임워크들 spring-webmvc, spring-webflux 는 스프링 프레임워크에서 나란히 공존하며 모듈들은 옵션입니다. 어플리케이션은 하나 또는 둘 다 사용할 수 있습니다. e.g 스프링 MVC 컨트롤러와 리액티브 웹클라이언트 새로운 웹프레임워크가 왜 필요할까? 대답의 일부로 적은 스레드 갯수로 비동기를 다루고 논블럭킹 웹스택과 적은 하드웨어 자원으로 확장이 필요하다는 것이다.">
<meta property="og:locale" content="ja_JP">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="durtchrt">
<meta name="twitter:url" content="http://durtchrt.github.io/blog/english/spring.io/webflux/">
<meta name="twitter:title" content="Spring WebFlux - durtchrt">
<meta name="twitter:description" content="Introduction 스프링 프레임워크, 스프링 Web MVC에 있는 웹프레임워크는 Servlet API와 Servlet 컨테이너를 만들기위한 용도였습니다. 반응형스택, 웹프레임워크, 스프링 웹플럭스는 5.0 버전 이후에 추가되었습니다. 완전한 논블럭킹, Reactive Streams 지원, 역압(back pressure) 그리고 Netty, Undertow, Servlet 3.1 이상 서버에서 동작합니다. 두 웹프레임워크들 spring-webmvc, spring-webflux 는 스프링 프레임워크에서 나란히 공존하며 모듈들은 옵션입니다. 어플리케이션은 하나 또는 둘 다 사용할 수 있습니다. e.g 스프링 MVC 컨트롤러와 리액티브 웹클라이언트 새로운 웹프레임워크가 왜 필요할까? 대답의 일부로 적은 스레드 갯수로 비동기를 다루고 논블럭킹 웹스택과 적은 하드웨어 자원으로 확장이 필요하다는 것이다.">
<meta name="twitter:image" content="http://durtchrt.github.io/blog/images/default.png">


<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "NewsArticle",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id":"http://durtchrt.github.io/blog/"
    },
    "headline": "Spring WebFlux - durtchrt",
    "image": {
      "@type": "ImageObject",
      "url": "http://durtchrt.github.io/blog/images/default.png",
      "height": 800,
      "width": 800
    },
    "datePublished": "2017-11-09T16:27:06JST",
    "dateModified": "2017-11-09T16:27:06JST",
    "author": {
      "@type": "Person",
      "name": "durtchrt"
    },
    "publisher": {
      "@type": "Organization",
      "name": "durtchrt",
      "logo": {
        "@type": "ImageObject",
        "url": "http://durtchrt.github.io/blog/images/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "description": "Introduction 스프링 프레임워크, 스프링 Web MVC에 있는 웹프레임워크는 Servlet API와 Servlet 컨테이너를 만들기위한 용도였습니다. 반응형스택, 웹프레임워크, 스프링 웹플럭스는 5.0 버전 이후에 추가되었습니다. 완전한 논블럭킹, Reactive Streams 지원, 역압(back pressure) 그리고 Netty, Undertow, Servlet 3.1 이상 서버에서 동작합니다.
 두 웹프레임워크들 spring-webmvc, spring-webflux 는 스프링 프레임워크에서 나란히 공존하며 모듈들은 옵션입니다. 어플리케이션은 하나 또는 둘 다 사용할 수 있습니다. e.g 스프링 MVC 컨트롤러와 리액티브 웹클라이언트
 새로운 웹프레임워크가 왜 필요할까? 대답의 일부로 적은 스레드 갯수로 비동기를 다루고 논블럭킹 웹스택과 적은 하드웨어 자원으로 확장이 필요하다는 것이다."
  }
</script>


    <style amp-custom>
      html { font-size: 18px; background-color: rgba(236,239,241,.5);}@media (max-width: 768px) { html { font-size: 15px; }}body { color: #333; font-family: 'Roboto Slab','ヒラギノ角ゴ Pro W3','Hiragino Kaku Gothic Pro',メイリオ,Meiryo,sans-serif; font-feature-settings : "palt"; font-size: inherit; line-height: 1rem; margin: 0; padding: 0;}h1, h2, h3, h4, h5 ,h6 { font-size: 1rem; font-weight: 700; line-height: 1rem; margin: 0;}hr { border: 0; border-top: 1px dashed #cfd8dc; margin: 1rem 0;}p { margin: 0; line-height: 1rem;}a { color: #2196f3; text-decoration: none; transition-duration: .3s;}ul, ol { margin: 0; padding: 0;}table { border-collapse: collapse;}th, td { font-size: .8rem; padding: .5rem;}tr { border-bottom: 1px dashed #ddd;}/* Layouts */main,aside { display: block;}main { padding: 1rem 0 3rem 0; }aside.h { padding: 3rem 0; }main.f,aside.f { background-color: #333; border-top: 2px dashed #fff; border-bottom: 2px dashed #fff;}.l-container { position: relative; max-width: 68rem; margin: 0 auto; padding: 0 1rem;}.l-container.thin { max-width: 44rem;}.l-header { background-color: #fff; box-shadow: 0 0 0 1px rgba(63,63,68,.05), 0 1px 3px rgba(63,63,68,.1), 0 1px 2px rgba(0,0,0,.05); padding: 1rem 0; text-align: center;}.l-header .description { margin-top: .5rem; font-size: .8rem;}.l-footer { background-color: #fff; box-shadow: 0 0 0 1px rgba(63,63,68,.05), 0 1px 3px rgba(63,63,68,.1), 0 1px 2px rgba(0,0,0,.05); font-size: .6rem; font-weight: 700; padding: 1rem 0;}@media (max-width: 768px) { .l-sidebar { margin-top: 4rem; }}.mrow { margin: 0 -1rem; overflow: hidden;}.mcol { box-sizing: border-box; float: left; padding: 0 1rem;}.c6 { width: 50%; }.c4 { width: 33.26323833%; }.c8 { width: 66.66666%; }@media (max-width: 768px) { .mcol { width: 100%; float: none; }}.logo a { font-size: 1.4rem; line-height: 1.5rem; font-weight: 700; color: #333;}.articles { margin: -1rem 0; margin-bottom: 1rem;}.articles.sm { margin: -.5rem 0; margin-bottom: 0;}article { border-radius: 4px; overflow: hidden;}article.li { background-color: #fff; box-shadow: 0 0 0 1px rgba(63,63,68,.05), 0 1px 3px rgba(63,63,68,.1), 0 1px 2px rgba(0,0,0,.05); height: 20rem; overflow: hidden; margin: 1rem 0;}article.li > a { display: block; color: #333;}article.li .inner { padding: 1rem;}article.li .thumb { height: 8rem;}article.li .title { color: #333; font-size: 1.2rem; line-height: 1.5rem; margin-bottom: .5rem;}article.li .summary { font-size: .8rem; height: 6rem; overflow: hidden; margin-top: 1rem;}article.li .summary::after { content: '...';}article.lism { background-color: #fff; box-shadow: 0 0 0 1px rgba(63,63,68,.05), 0 1px 3px rgba(63,63,68,.1), 0 1px 2px rgba(0,0,0,.05); margin: .5rem 0;}article.lism::after { content: ''; display: block; clear: both;}article.lism > a { display: block; color: #333;}article.lism .inner { display: table-cell; vertical-align: middle; height: 5rem; padding: 0 .75rem;}article.lism .thumb { width: 5rem; height: 5rem; float: left;}article.lism .title { font-weight: 700; font-size: .8rem; margin-bottom: .25rem;}article.sn { background-color: #fff; box-shadow: 0 0 0 1px rgba(63,63,68,.05), 0 1px 3px rgba(63,63,68,.1), 0 1px 2px rgba(0,0,0,.05); margin-bottom: 1rem;}article.sn .thumb { height: 20rem;}@media (max-width: 768px) { article.sn .thumb { height: 10rem; }}article.sn > .article-header,article.sn > .article-body,article.sn .article-footer { padding: 2rem;}article.sn > .article-body { padding: 0 2rem;}@media (max-width: 768px) { article.sn > .article-header, article.sn > .article-body, article.sn .article-footer { padding: 1rem; } article.sn > .article-body { padding: 0 1rem; }}article.sn > .article-header .title { font-size: 1.8rem; line-height: 2rem; margin-bottom: .5rem;}@media (max-width: 768px) { article.sn > .article-header .title { font-size: 1.4rem; line-height: 1.5rem; }}article.sn > .article-header .facts { margin-bottom: 1rem;}article.sn > .article-body { margin-bottom: 1.5rem;}article.sn > .article-body h2 { border-bottom: .25rem solid #333; font-size: 1.2rem; line-height: 1.5rem; margin: 1.5rem 0; padding: .5rem 0;}article.sn > .article-body h3 { border-left: .5rem solid #333; line-height: 1.5rem; margin: 1.5rem 0; padding: .125rem .5rem;}article.sn > .article-body ul,article.sn > .article-body ol { margin: 1.5rem 0; padding-left: 1.5rem;}article.sn > .article-body li { padding-bottom: .5rem; line-height: 1.5rem;}article.sn > .article-body li:last-child { padding-bottom: 0;}article.sn > .article-body p { margin: 1rem 0; line-height: 1.5rem;}article.sn > .article-body strong,article.sn > .article-body em { font-style: normal; font-weight: 700;}article.sn > .article-body strong { box-shadow: 0 -.5rem 0 0 #ffc107 inset;}article.sn > .article-body em { color: #8bc34a;}article.sn > .article-body code,article.sn > .article-body pre { font-family: Menlo, Consolas, monospace; font-size: .7rem;}article.sn > .article-body pre { background-color: #333; color: #fff; line-height: 1rem; margin: 1.5rem -2rem; overflow: auto;}@media (max-width: 768px) { article.sn > .article-body pre { margin: 1.5rem -1rem; }}article.sn > .article-body pre > code { display: block; padding: 1rem 2rem;}@media (max-width: 768px) { article.sn > .article-body pre > code { padding: 1rem; }}article.sn > .article-body p code { background-color: #eceff1; color: #333; border-radius: 4px; margin: 0 .25rem; padding: .375rem; white-space: nowrap;}article.sn > .article-body blockquote { position: relative; border-left: .25rem solid #333; font-size: .8rem; padding: .125rem 1rem; margin: 1.5rem 0;}@media (max-width: 768px) { article.sn > .article-body blockquote { font-size: 1rem; }}article.sn > .article-body blockquote p { margin: .5rem 0; line-height: 1rem;}article.sn > .article-body figure { margin: 1.5rem 0;}article.sn > .article-body figure img,article.sn > .article-body figure amp-img { box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); max-width: 100%;}article.sn > .article-body figcaption { color: #cfd8dc; font-size: .8rem; font-weight: 700; margin-top: .5rem;}.facts li { display: inline; font-size: .8rem; margin-right: 1rem;}.facts i { color: #cfd8dc; margin-right: .5em;}.facts.sm li { font-size: .7rem;}.sections.sidebar { margin: -1rem 0;}.sections.footer { margin: -1rem 0;}section.sidebar { margin: 2rem 0;}section.sidebar > header { font-size: .8rem; font-weight: 700; letter-spacing: 4px; text-align: center; margin: 1.5rem 0;}section.footer { margin: 1rem 0;}section.footer > header { font-size: .8rem; margin: .5rem 0;}section.footer > header::before { content: "- ";}section.footer > header a { font-weight: 700; color: #333; text-decoration: underline;}.terms { margin: -.25rem;}.terms li { display: inline-block;}.terms a { display: block; float: left; background-color: #333; border-radius: 4px; color: #fff; font-size: .7rem; margin: .25rem; padding: 0 .75rem; line-height: 1.75rem;}.paging { text-align: center; padding: 1rem 0;}.paging a { display: inline-block; background-color: #fff; box-shadow: 0 0 0 1px rgba(63,63,68,.05), 0 1px 3px rgba(63,63,68,.1), 0 1px 2px rgba(0,0,0,.05); border-radius: 4px; color: #333; padding: 0 1rem; line-height: 3rem;}.page-title { text-align: center; margin: 1rem 0;}.page-title::after { content: ''; display: block; border-bottom: .25rem solid #333; width: 3rem; margin: 1.5rem auto;}.page-title > .title { font-size: 1.2rem; line-height: 1.5rem;}/* Parts:breadcrumb */.crumb ol { text-overflow: ellipsis; color: #cfd8dc; white-space: nowrap; overflow: hidden;}.crumb li { display: inline; font-size: .8rem;}.crumb li::after { content: '›'; margin: 0 .25rem 0 .5rem;}.crumb li:last-child::after { content: '';}.crumb a { color: #cfd8dc;}.crumb i { margin-right: .5em;}.share { padding: 0;}.share a { display: inline-block; box-shadow: 0 0 0 1px rgba(63,63,68,.05), 0 1px 3px rgba(63,63,68,.1), 0 1px 2px rgba(0,0,0,.05); min-width: 1rem; height: 2rem; border-radius: 4px; color: #333; font-size: .8rem; font-weight: 700; line-height: 2rem; text-align: center; padding: 0 .5rem;}.adj article.lism { margin-bottom: 1rem;}.adj header { font-weight: 700; font-size: .8rem;}.toc { padding: 0 2rem;}@media (max-width: 768px) { .toc { padding: 0 1rem; }}.toc { margin: 1rem 0;}.toc nav>ul { background-color: #eceff1; border-radius: 4px; display: inline-block; font-size: .8rem; padding: .5rem 1rem; word-break: break-all; list-style: none;}.toc ul { padding: 0;}.toc ul ul { padding-left: 1rem;}.toc ul ul ul { padding-left: 1rem;}.toc li { color: #90a4ae;}.toc ul ul>li { font-weight: 700; margin: .5rem 0; list-style-type: decimal;}.toc ul ul ul>li { list-style-type: disc; font-weight: 500;}.author { background-color: #fff; box-shadow: 0 0 0 1px rgba(63,63,68,.05), 0 1px 3px rgba(63,63,68,.1), 0 1px 2px rgba(0,0,0,.05); padding: 1rem; border-radius: 4px; text-align: center;}.author .author-thumb { margin: 0 auto 1rem; width: 6rem; height: 6rem; border-radius: 50%; background-color: #eceff1; background-size: cover; background-position: center;}.author .author-name { margin-bottom: .5rem; font-weight: 700;}.author .author-facts { margin-bottom: 1rem;}.author .author-facts li { display: inline;}.author .author-facts li a { display: inline-block; background-color: #eceff1; width: 1.75rem; height: 1.75rem; line-height: 1.75rem; text-align: center; color: #333; font-size: .8rem; border-radius: 2px;}.author .author-facts li a:hover { color: #fff; background-color: #333;}.author .author-description { text-align: left; font-size: .8rem;}.author .author-description p { margin: .5rem 0;}.thumb { background-image: url(http://durtchrt.github.io/blog/images/default.jpg); background-size: cover; background-position: center;}
      
       body { font-family: Lato,YuGothic,'Hiragino Kaku Gothic Pro',Meiryo,sans-serif; } 
       .h-logo { font-family: Lobster, cursive; } 
      .l-container { max-width: 40rem; margin: 0 auto; }
    </style>
  </head>

  <body>
    
    <amp-analytics type="googleanalytics" id="analytics1">
      <script type="application/json"> { "vars": { "account": "UA-108897430-1"}, "triggers": { "trackPageview": { "on": "visible", "request": "pageview" } } }
      </script>
    </amp-analytics>
    

    <header class="l-header">
      <div class="l-container">
        <div class="logo">
          <a href="http://durtchrt.github.io/blog/">durtchrt</a>
        </div>
      </div>
    </header>

    <main>
      <div class="l-container">
        
<article class="sn">

  <div class="thumb thumb-4492b087f98d219820a0d1d190ea0e13"></div>

  <header class="article-header">
    <h1 class="title">Spring WebFlux</h1>

    <ul class="facts">
      <li><i class="fa fa-calendar" aria-hidden="true"></i><time datetime="2017-11-09T16:27:06JST">Nov 9, 2017</time></li>
      <li><i class="fa fa-bookmark" aria-hidden="true"></i><a href="http://durtchrt.github.io/blog/english/">ENGLISH</a></li>
      
    </ul>

    <aside class="share">
  <a href="http://b.hatena.ne.jp/add?mode=confirm&url=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f&title=Spring%20WebFlux" title="はてなブックマーク" class="ht" target="_blank" rel="nofollow">B!</a>
  <a href="http://twitter.com/intent/tweet?url=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f&text=Spring%20WebFlux&tw_p=tweetbutton" title="Twitterでシェア" class="tw" target="_blank" rel="nofollow"><i class="fa fa-twitter" aria-hidden="true"></i></a>
  <a href="http://www.facebook.com/sharer.php?u=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f&t=Spring%20WebFlux" title="Facebookでシェア" class="fb" target="_blank" rel="nofollow"><i class="fa fa-facebook" aria-hidden="true"></i></a>
  <a href="https://plus.google.com/share?url=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f" title="Google Plusでシェア" class="gp" target="_blank" rel="nofollow"><i class="fa fa-google-plus" aria-hidden="true"></i></a>
  <a href="http://getpocket.com/edit?url=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f&title=Spring%20WebFlux" title="Pocketに保存" class="pk" target="_blank" rel="nofollow"><i class="fa fa-get-pocket" aria-hidden="true"></i></a>
  <a href="http://line.me/R/msg/text/?Spring%20WebFlux http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f" title="LINEでシェア" class="ln" target="_blank" rel="nofollow">LINE</a>
</aside>

  </header>

  

  <div class="article-body"><div class="sect1">
<h2 id="webflux-introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>스프링 프레임워크, 스프링 Web MVC에 있는 웹프레임워크는
Servlet API와 Servlet 컨테이너를 만들기위한 용도였습니다. 반응형스택, 웹프레임워크,
스프링 웹플럭스는 5.0 버전 이후에 추가되었습니다. 완전한 논블럭킹,
<a href="http://www.reactive-streams.org/">Reactive Streams</a> 지원, 역압(back pressure) 그리고
Netty, Undertow, Servlet 3.1 이상 서버에서 동작합니다.</p>
</div>
<div class="paragraph">
<p>두 웹프레임워크들
<a href="https://github.com/spring-projects/spring-framework/tree/master/spring-webmvc">spring-webmvc</a>,
<a href="https://github.com/spring-projects/spring-framework/tree/master/spring-webflux">spring-webflux</a> 는
스프링 프레임워크에서 나란히 공존하며 모듈들은 옵션입니다.
어플리케이션은 하나 또는 둘 다 사용할 수 있습니다.
e.g 스프링 MVC 컨트롤러와 리액티브 <code>웹클라이언트</code></p>
</div>
<div class="sect2">
<h3 id="webflux-new-framework">새로운 웹프레임워크가 왜 필요할까?</h3>
<div class="paragraph">
<p>대답의 일부로 적은 스레드 갯수로 비동기를 다루고 논블럭킹 웹스택과
적은 하드웨어 자원으로 확장이 필요하다는 것이다.서블렛 3.1은
논블럭킹 I/O API를 지원했다. 하지만, 동기(<code>Filter</code>, <code>Servlet</code>), 블럭킹(<code>getParameter</code>, <code>getPart</code>)은 Servlet API로 부터 멀어지게합니다.
using it leads away from the rest of the Servlet API where contracts are synchronous (<code>Filter</code>, <code>Servlet</code>) or blocking (<code>getParameter</code>,<code>getPart</code>).
이것이 모든 논블럭킹 런타임에 대해 기반 역할을하는 새로운 공통 API 설계 동기였습니다.
그건 네티처럼 비동기, 논블럭이 잘만들어진 서버들 때문에 중요합니다.</p>
</div>
<div class="paragraph">
<p>다른 대답으로는 함수형 프로그래밍입니다. Java 5때 어노테이션
추가처럼 기회가 생겼습니다.&#8201;&#8212;&#8201;e.g. 어노테이션이 붙은 REST 컨트롤러나 단위 테스트.
자바8에 람다 표현식이 추가됨은 자바에서 함수형 API를 이용할 기회가 생겼습니다.
이건 논블럭킹 어플리케이션과 continuation 스타일 API에 도움이 됩니다.&#8201;&#8212;&#8201;대중화된 `CompletableFuture`나
<a href="http://reactivex.io/">ReactiveX</a>는 비동기 로직의 선언적 구성을 허용합니다.
자바8은 스프링 웹플럭스가 어노테이션이 붙은 컨트롤러와 함께 함수형 웹 엔드포인트를 제공할 수 있게하였습니다.</p>
</div>
</div>
<div class="sect2">
<h3 id="webflux-why-reactive">리액티브: 무엇이고 왜 쓰는거야?</h3>
<div class="paragraph">
<p>우리는 논블럭킹과 함수형에 다가갔지만 왜 리액티브이며 우리에게 어떤 의미일까?</p>
</div>
<div class="paragraph">
<p>"리액티브" 용어는 변화에 반응하는 프로그램 모델을 가리킨다.&#8201;&#8212;&#8201;네트워크 컨퍼넌트는 I/O 이벤트에 반응하고, UI 컨트롤러는 마우스 이벤트에 반응하고 기타.
그런 의미에서 논블럭킹은 완료 오퍼레이션이나 사용할수 있는 데이터에 반응합니다.
논블럭킹 역압 또한 중요한 메카니즘입니다.  동기, 명령형 코드, 블럭킹 호출에서 클라이언트를 기다리게 강제하는 것은 자연스러운 것이였다.
하지만 논블럭킹 코드는 처리하는 놈의 처리량을 넘치지 않게 이벤트 속도를 조절하는 것이 중요합니다.</p>
</div>
<div class="paragraph">
<p>리액티브 스트림은 <a href="https://github.com/reactive-streams/reactive-streams-jvm/blob/v1.0.1/README.md#specification">small spec</a> 와
자바 9의 <a href="http://download.java.net/java/jdk9/docs/api/java/util/concurrent/Flow.html">adopted</a> 이며 이들은 역압과 비동기 구성요소들간 상호작용을 정의합니다.
예를들어 데이터 저장소&#8201;&#8212;&#8201;<a href="http://www.reactive-streams.org/reactive-streams-1.0.1-javadoc/org/reactivestreams/Publisher.html">Publisher</a>는
HTTP 서버처럼 데이터를 생성할 수 있습니다.
<a href="http://www.reactive-streams.org/reactive-streams-1.0.1-javadoc/org/reactivestreams/Subscriber.html">Subscriber</a>는 응답을 쓸수 있습니다.
리액티브 스트림의 주요 목적은 구독자가 퍼블리셔가 발생하는 데이터를 조절하는데 있습니다.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><strong>질문: 퍼블리셔가 속도를 늦출수 없다면 어쩌죠?</strong><br>
(The purpose of Reactive Streams is only to establish the mechanism and a boundary.)
만약 퍼블리셔가 속도를 늦출수 없다면 (역자 - 누가?) 버퍼링, 삭제 또는 실패를 결정해야합니다.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="webflux-reactive-api">리액티브 API</h3>
<div class="paragraph">
<p>리액티브 스트림은 상오 운용성에 중용한 역할을 합니다.
그건 라이브러리나 하부구조인데 너무 로우레벨이라 어플리케이션 API에 유용하지 않다. 어플리케이션이 원하는건
비동기 로직을 구성하는데 필요로하는 더 추상화되고 더 풍부한 표현력을 가진 함수형 API이다.&#8201;&#8212;&#8201;컬렉션만 적용된 자바 8 <code>Stream</code> API와 유사하다.
이게 리액티브 라이브러리가 수행하는 역할입니다.</p>
</div>
<div class="paragraph">
<p><a href="https://github.com/reactor/reactor">Reactor</a>은 Spring WebFlux를 위해 선택한 리액티브 라이브러리입니다.
이건 <a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Mono.html">Mono</a> 와
<a href="https://projectreactor.io/docs/core/release/api/reactor/core/publisher/Flux.html">Flux</a> API 타입들은
ReactiveX의 <a href="http://reactivex.io/documentation/operators.html">vocabulary of operators</a>와 비슷한 풍부한 오퍼레잍터들을 통해
0..1(Mono)과 0..N(Flux)의 데이터 시퀀스에서 작업할 수 있습니다.
리액터는 리액티브 스트림스 라이브러리이며 오퍼레이터는 논블록킹 역압을 지원합니다.
리액터는 서버사이드쪽의 자바에 특화되어있습니다. 스프링과 함께 가깝게 협업하며 개발되고 있습니다.</p>
</div>
<div class="paragraph">
<p>웹플럭스는 핵심 디펜던시로 리액터를 필요로합니다만 리액티브 스트림스를 통해 다른 리액티브 라이브러리랑 호환됩니다.(역 - Reactive streams는 interface, reactor와 rxjava는 구현체)
일반적으로 웹플럭스 API들은 `Publisher`를 입력으로 받고 내부적으로 Reactor 타입으로 적용시킨다. 그리고
`Flux`나 `Mono`를 결과로 반환합니다. 그럼 당신은 `Publisher`를 입력값으로 전달하고 결과값에 오퍼레이션들을 적용킬수 있다.&#8201;&#8212;&#8201;e.g. 어노테이션이 붙은 컨트롤러, 웹플럭스는 RxJava나 다른 리액티브 라이브러리를 적용할 수 있습니다.
<a href="#웹플럭스-리액티브-라이브러리">[웹플럭스-리액티브-라이브러리]</a>에 더 상세하게 있습니다.</p>
</div>
</div>
<div class="sect2">
<h3 id="webflux-programming-models">Programming models</h3>
<div class="paragraph">
<p>The <code>spring-web</code> module contains the reactive foundation that underlies Spring WebFlux&#8201;&#8212;&#8201;HTTP abstractions, Reactive Streams server adapters, reactive codecs, and a
core Web API whose role is comparable to the Servlet API but with non-blocking semantics.</p>
</div>
<div class="paragraph">
<p>On that foundation Spring WebFlux provides a choice of two programming models:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#webflux-controller">Annotated Controllers</a>&#8201;&#8212;&#8201;consistent with Spring MVC, and based on the same annotations
from the <code>spring-web</code> module. Both Spring MVC and WebFlux controllers support reactive
(Reactor, RxJava) return types and as a result it is not easy to tell them apart. One notable
difference is that WebFlux also supports reactive <code>@RequestBody</code> arguments.</p>
</li>
<li>
<p><a href="#webflux-fn">[webflux-fn]</a>&#8201;&#8212;&#8201;lambda-based, lightweight, functional programming model. Think of
this as a small library or a set of utilities that an application can use to route and
handle requests. The big difference with annotated controllers is that the application
is in charge of request handling from start to finish vs declaring intent through
annotations and being called back.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="webflux-framework-choice">Choosing a web framework</h3>
<div class="paragraph">
<p>Should you use Spring MVC or WebFlux? Let&#8217;s cover a few different perspectives.</p>
</div>
<div class="paragraph">
<p>If you have a Spring MVC application that works fine, there is no need to change.
Imperative programming is the easiest way to write, understand, and debug code.
You have maximum choice of libraries since historically most are blocking.</p>
</div>
<div class="paragraph">
<p>If you are already shopping for a non-blocking web stack, Spring WebFlux offers the same
execution model benefits as others in this space and also provides a choice of servers&#8201;&#8212;&#8201;Netty, Tomcat, Jetty, Undertow, Servlet 3.1+ containers, a choice of programming models&#8201;&#8212;&#8201;annotated controllers and functional web endpoints, and a choice of reactive libraries&#8201;&#8212;&#8201;Reactor, RxJava, or other.</p>
</div>
<div class="paragraph">
<p>If you are interested in a lightweight, functional web framework for use with Java 8 lambdas
or Kotlin then use the Spring WebFlux functional web endpoints. That can also be a good choice
for smaller applications or microservices with less complex requirements that can benefit
from greater transparency and control.</p>
</div>
<div class="paragraph">
<p>In a microservice architecture you can have a mix of applications with either Spring MVC
or Spring WebFlux controllers, or with Spring WebFlux functional endpoints. Having support
for the same annotation-based programming model in both frameworks makes it easier to
re-use knowledge while also selecting the right tool for the right job.</p>
</div>
<div class="paragraph">
<p>A simple way to evaluate an application is to check its dependencies. If you have blocking
persistence APIs (JPA, JDBC), or networking APIs to use, then Spring MVC is the best choice
for common architectures at least. It is technically feasible with both Reactor and
RxJava to perform blocking calls on a separate thread but you wouldn&#8217;t be making the
most of a non-blocking web stack.</p>
</div>
<div class="paragraph">
<p>If you have a Spring MVC application with calls to remote services, try the reactive <code>WebClient</code>.
You can return reactive types (Reactor, RxJava, <a href="#webflux-reactive-libraries">or other</a>)
directly from Spring MVC controller methods. The greater the latency per call, or the
interdependency among calls, the more dramatic the benefits. Spring MVC controllers
can call other reactive components too.</p>
</div>
<div class="paragraph">
<p>If you have a large team, keep in mind the steep learning curve in the shift to non-blocking,
functional, and declarative programming. A practical way to start without a full switch
is to use the reactive <code>WebClient</code>. Beyond that start small and measure the benefits.
We expect that for a wide range of applications the shift is unnecessary.</p>
</div>
<div class="paragraph">
<p>If you are unsure what benefits to look for, start by learning about how non-blocking I/O
works (e.g. concurrency on single-threaded Node.js is not an oxymoron) and its effects.
The tag line is "scale with less hardware" but that effect is not guaranteed, not without
some network I/O that can be slow or unpredictable. This Netflix
<a href="https://medium.com/netflix-techblog/zuul-2-the-netflix-journey-to-asynchronous-non-blocking-systems-45947377fb5c">blog post</a>
is a good resource.</p>
</div>
</div>
<div class="sect2">
<h3 id="webflux-server-choice">Choosing a server</h3>
<div class="paragraph">
<p>Spring WebFlux is supported on Netty, Undertow, Tomcat, Jetty, and Servlet 3.1+ containers.
Each server is adapted to a common Reactive Streams API. The Spring WebFlux programming
models are built on that common API.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Common question: how can Tomcat and Jetty be used in both stacks?</strong><br>
Tomcat and Jetty are non-blocking at their core. It&#8217;s the Servlet API that adds a
blocking facade. Starting in version 3.1 the Servlet API adds a choice for non-blocking I/O.
However its use requires care to avoid other synchronous and blocking parts. For this
reason Spring&#8217;s reactive web stack has a low-level Servlet adapter to bridge to Reactive
Streams but the Servlet API is otherwise not exposed for direct use.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring Boot 2 uses Netty by default with WebFlux because Netty is more widely used in the
async, non-blocking space and also provides both client and server that can share resources.
By comparison Servlet 3.1 non-blocking I/O hasn&#8217;t seen much use because the bar to use it
is so high. Spring WebFlux opens one practical path to adoption.</p>
</div>
<div class="paragraph">
<p>The default server choice in Spring Boot is mainly about the out-of-the-box experience.
Applications can still choose any of the other supported servers which are also highly
optimized for performance, fully non-blocking, and adapted to Reactive Streams back
pressure. In Spring Boot it is trivial to make the switch.</p>
</div>
</div>
<div class="sect2">
<h3 id="webflux-performance">Performance vs scale</h3>
<div class="paragraph">
<p>Performance has many characteristics and meanings. Reactive and non-blocking generally
do not make applications run faster. They can, in some cases, for example if using the
<code>WebClient</code> to execute remote calls in parallel. On the whole it requires more work to do
things the non-blocking way and that can increase slightly the required processing time.</p>
</div>
<div class="paragraph">
<p>The key expected benefit of reactive and non-blocking is the ability to scale with a small,
fixed number of threads and less memory. That makes applications more resilient under load
because they scale in a more predictable way. In order to observe those benefits however you
need to have some latency including a mix of slow and unpredictable network I/O.
That&#8217;s where the reactive stack begins to show its strengths and the differences can be
dramatic.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webflux-reactive-spring-web">Reactive Spring Web</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>spring-web</code> module provides low level infrastructure and HTTP abstractions&#8201;&#8212;&#8201;client
and server, to build reactive web applications. All public APIs are build around Reactive
Streams with Reactor as a backing implementation.</p>
</div>
<div class="paragraph">
<p>Server support is organized in two layers:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#webflux-httphandler">HttpHandler</a> and server adapters&#8201;&#8212;&#8201;the most basic, common API
for HTTP request handling with Reactive Streams back pressure.</p>
</li>
<li>
<p><a href="#webflux-web-handler-api">WebHandler API</a>&#8201;&#8212;&#8201;slightly higher level but still general
purpose server web API with filter chain style processing.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="webflux-httphandler">HttpHandler</h3>
<div class="paragraph">
<p>Every HTTP server has some API for HTTP request handling.
{api-spring-framework}/http/server/reactive/HttpHandler.html[HttpHandler]
is a simple contract with one method to handle a request and response.
It is intentionally minimal. Its main purpose is to provide a common, Reactive Streams
based API for HTTP request handling over different servers.</p>
</div>
<div class="paragraph">
<p>The <code>spring-web</code> module contains adapters for every supported server. The table below shows
the server APIs are used and where Reactive Streams support comes from:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 20%;">
<col style="width: 40%;">
<col style="width: 40%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Server name</th>
<th class="tableblock halign-left valign-top">Server API used</th>
<th class="tableblock halign-left valign-top">Reactive Streams support</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Netty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Netty API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/reactor/reactor-netty">Reactor Netty</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undertow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undertow API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-web: Undertow to Reactive Streams bridge</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tomcat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Servlet 3.1 non-blocking I/O; Tomcat API to read and write ByteBuffers vs byte[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-web: Servlet 3.1 non-blocking I/O to Reactive Streams bridge</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jetty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Servlet 3.1 non-blocking I/O; Jetty API to write ByteBuffers vs byte[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-web: Servlet 3.1 non-blocking I/O to Reactive Streams bridge</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Servlet 3.1 container</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Servlet 3.1 non-blocking I/O</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">spring-web: Servlet 3.1 non-blocking I/O to Reactive Streams bridge</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Here are required dependencies,
<a href="https://github.com/spring-projects/spring-framework/wiki/What%27s-New-in-the-Spring-Framework">supported versions</a>,
and code snippets for each server:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Server name</th>
<th class="tableblock halign-left valign-top">Group id</th>
<th class="tableblock halign-left valign-top">Artifact name</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Reactor Netty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">io.projectreactor.ipc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reactor-netty</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Undertow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">io.undertow</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">undertow-core</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tomcat</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.apache.tomcat.embed</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tomcat-embed-core</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jetty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org.eclipse.jetty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">jetty-server, jetty-servlet</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Reactor Netty:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpHandler handler = ...
ReactorHttpHandlerAdapter adapter = new ReactorHttpHandlerAdapter(handler);
HttpServer.create(host, port).newHandler(adapter).block();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Undertow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpHandler handler = ...
UndertowHttpHandlerAdapter adapter = new UndertowHttpHandlerAdapter(handler);
Undertow server = Undertow.builder().addHttpListener(port, host).setHandler(adapter).build();
server.start();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tomcat:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpHandler handler = ...
Servlet servlet = new TomcatHttpHandlerAdapter(handler);

Tomcat server = new Tomcat();
File base = new File(System.getProperty("java.io.tmpdir"));
Context rootContext = server.addContext("", base.getAbsolutePath());
Tomcat.addServlet(rootContext, "main", servlet);
rootContext.addServletMappingDecoded("/", "main");
server.setHost(host);
server.setPort(port);
server.start();</code></pre>
</div>
</div>
<div class="paragraph">
<p>Jetty:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpHandler handler = ...
Servlet servlet = new JettyHttpHandlerAdapter(handler);

Server server = new Server();
ServletContextHandler contextHandler = new ServletContextHandler(server, "");
contextHandler.addServlet(new ServletHolder(servlet), "/");
contextHandler.start();

ServerConnector connector = new ServerConnector(server);
connector.setHost(host);
connector.setPort(port);
server.addConnector(connector);
server.start();</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>To deploy as a WAR to a Servlet 3.1+ container, wrap <code>HttpHandler</code> with
<code>ServletHttpHandlerAdapter</code> and register that as a <code>Servlet</code>.
This can be automated through the use of
{api-spring-framework}/web/server/adapter/AbstractReactiveWebInitializer.html[AbstractReactiveWebInitializer].</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="webflux-web-handler-api">WebHandler API</h3>
<div class="paragraph">
<p><code>HttpHandler</code> is the basis for running on different servers. On that base the WebHandler
API provides a slightly higher level processing chain of
exception handlers
({api-spring-framework}/web/server/WebExceptionHandler.html[WebExceptionHandler]), filters
({api-spring-framework}/web/server/WebFilter.html[WebFilter]), and a target handler
({api-spring-framework}/web/server/WebHandler.html[WebHandler]).</p>
</div>
<div class="paragraph">
<p>All components work on <code>ServerWebExchange</code>&#8201;&#8212;&#8201;a container for the HTTP request and
response that also adds request attributes, session attributes, access to form data,
multipart data, and more.</p>
</div>
<div class="paragraph">
<p>The processing chain can be put together with <code>WebHttpHandlerBuilder</code> which builds an
<code>HttpHandler</code> that in turn can be run with a <a href="#webflux-httphandler">server adapter</a>.
To use the builder either add components individually or point to an <code>ApplicationContext</code>
to have the following detected:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 12.5%;">
<col style="width: 37.5%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Bean name</th>
<th class="tableblock halign-left valign-top">Bean type</th>
<th class="tableblock halign-left valign-top">Count</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"webHandler"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WebHandler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Target handler after filters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;any&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WebFilter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Filters</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">&lt;any&gt;</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WebExceptionHandler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..N</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exception handlers after filter chain</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"webSessionManager"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WebSessionManager</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom session manager; <code>DefaultWebSessionManager</code> by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"serverCodecConfigurer"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ServerCodecConfigurer</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom form and multipart data decoders; <code>ServerCodecConfigurer.create()</code> by default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">"localeContextResolver"</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LocaleContextResolver</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0..1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Custom resolver for <code>LocaleContext</code>; <code>AcceptHeaderLocaleContextResolver</code> by default</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="webflux-codecs">Codecs</h3>
<div class="paragraph">
<p>The <code>spring-web</code> module provides
{api-spring-framework}/http/codec/HttpMessageReader.html[HttpMessageReader] and
{api-spring-framework}/http/codec/HttpMessageWriter.html[HttpMessageWriter]
for encoding and decoding the HTTP request and response body with Reactive Streams.
It builds on lower level contracts from <code>spring-core</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>{api-spring-framework}/core/io/buffer/DataBuffer.html[DataBuffer]&#8201;&#8212;&#8201;abstraction for
byte buffers&#8201;&#8212;&#8201;e.g. Netty <code>ByteBuf</code>, <code>java.nio.ByteBuffer</code></p>
</li>
<li>
<p>{api-spring-framework}/core/codec/Encoder.html[Encoder]&#8201;&#8212;&#8201;serialize a stream of Objects
to a stream of data buffers</p>
</li>
<li>
<p>{api-spring-framework}/core/codec/Decoder.html[Decoder]&#8201;&#8212;&#8201;deserialize a stream of data
buffers into a stream of Objects</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Basic <code>Encoder</code> and <code>Decoder</code> implementations exist in <code>spring-core</code> but <code>spring-web</code> adds
more for JSON, XML, and other formats. You can wrap any <code>Encoder</code> and <code>Decoder</code> as a reader
or writer with <code>EncoderHttpMessageWriter</code> and <code>DecoderHttpMessageReader</code>. There are some
additional, web-only reader and writer implementations for server-sent events, form data,
and more.</p>
</div>
<div class="paragraph">
<p>Finally, <code>ClientCodecConfigurer</code> and <code>ServerCodecConfigurer</code> can be used to initialize
a list of readers and writers. They include support for classpath detection and a
of defaults along with the ability to override or replace those defaults.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webflux-dispatcher-handler">DispatcherHandler</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-servlet">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>Spring WebFlux, like Spring MVC, is designed around the front controller pattern where a
central <code>WebHandler</code>, the <code>DispatcherHandler</code>, provides a shared algorithm for request
processing while actual work is performed by configurable, delegate components.
This model is flexible and supports diverse workflows.</p>
</div>
<div class="paragraph">
<p><code>DispatcherHandler</code> discovers the delegate components it needs from Spring configuration.
It is also designed to be a Spring bean itself and implements <code>ApplicationContextAware</code>
for access to the context it runs in. If <code>DispatcherHandler</code> is declared with the bean
name "webHandler" it is in turn discovered by
{api-spring-framework}/web/server/adapter/WebHttpHandlerBuilder.html[WebHttpHandlerBuilder]
which puts together a request processing chain as described in
<a href="#webflux-web-handler-api">WebHandler API</a>.</p>
</div>
<div class="paragraph">
<p>Spring configuration in a WebFlux application typically contains:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DispatcherHandler</code> with the bean name "webHandler"</p>
</li>
<li>
<p><code>WebFilter</code> and <code>WebExceptionHandler</code> beans</p>
</li>
<li>
<p><a href="#webflux-special-bean-types">DispatcherHandler special beans</a></p>
</li>
<li>
<p>Others</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The configuration is given to <code>WebHttpHandlerBuilder</code> to build the processing chain:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">ApplicationContext context = ...
HttpHandler handler = WebHttpHandlerBuilder.applicationContext(context);</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resulting <code>HttpHandler</code> is ready for use with a
<a href="#webflux-httphandler">server adapter</a>.</p>
</div>
<div class="sect2">
<h3 id="webflux-special-bean-types">Special bean types</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-servlet-special-bean-types">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>The <code>DispatcherHandler</code> delegates to special beans to process requests and render the
appropriate responses. By "special beans" we mean Spring-managed Object instances that
implement one of the framework contracts listed in the table below.
Spring WebFlux provides built-in implementations of these contracts but you can also
customize, extend, or replace them.</p>
</div>
<table id="webflux-special-beans-table" class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Bean type</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HandlerMapping</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map a request to a handler. The mapping is based on some criteria the details of
  which vary by <code>HandlerMapping</code> implementation&#8201;&#8212;&#8201;annotated controllers, simple
  URL pattern mappings, etc.</p>
<p class="tableblock">  The main <code>HandlerMapping</code> implementations are <code>RequestMappingHandlerMapping</code> based on
  <code>@RequestMapping</code> annotated methods, <code>RouterFunctionMapping</code> based on functional
  endpoint routes, and <code>SimpleUrlHandlerMapping</code> based on explicit registrations of URI
  path patterns to handlers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HandlerAdapter</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Help the <code>DispatcherHandler</code> to invoke a handler mapped to a request regardless of
  how the handler is actually invoked. For example invoking an annotated controller
  requires resolving annotations. The main purpose of a <code>HandlerAdapter</code> is to shield the
  <code>DispatcherHandler</code> from such details.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HandlerResultHandler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Process the result from the handler invocation and finalize the response.</p>
<p class="tableblock">  The built-in <code>HandlerResultHandler</code> implementations are <code>ResponseEntityResultHandler</code>
  supporting <code>ResponseEntity</code> return values, <code>ResponseBodyResultHandler</code>
  supporting <code>@ResponseBody</code> methods, <code>ServerResponseResultHandler</code>
  supporting the <code>ServerResponse</code> returned from functional endpoints, and
  <code>ViewResolutionResultHandler</code> supporting rendering with a view and a model.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="webflux-framework-config">Framework Config</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-servlet-config">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>The <code>DispatcherHandler</code> detects the special beans it needs in the <code>ApplicationContext</code>.
Applications can declare the special beans they wish to have. However most applications
will find a better starting point in the WebFlux Java config which provide a higher level
configuration API that in turn make the necessary bean declarations.
See <a href="#webflux-config">WebFlux Java Config</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="webflux-dispatcher-handler-sequence">Processing</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-servlet-sequence">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>The <code>DispatcherHandler</code> processes requests as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Each <code>HandlerMapping</code> is asked to find a matching handler and the first match is used.</p>
</li>
<li>
<p>If a handler is found, it is executed through an appropriate <code>HandlerAdapter</code> which
exposes the return value from the execution as <code>HandlerResult</code>.</p>
</li>
<li>
<p>The <code>HandlerResult</code> is given to an appropriate <code>HandlerResultHandler</code> to complete
processing by writing to the response directly or using a view to render.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webflux-controller">Annotated Controllers</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-controller">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>Spring WebFlux provides an annotation-based programming model where <code>@Controller</code> and
<code>@RestController</code> components use annotations to express request mappings, request input,
exception handling, and more. Annotated controllers have flexible method signatures and
do not have to extend base classes nor implement specific interfaces.</p>
</div>
<div class="paragraph">
<p>Here is a basic example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestController
public class HelloController {

	@GetMapping("/hello")
	public String handle() {
		return "Hello WebFlux";
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example the methods returns a String to be written to the response body.</p>
</div>
<div class="sect2">
<h3 id="webflux-ann-controller">@Controller</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-controller">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>You can define controller beans using a standard Spring bean definition.
The <code>@Controller</code> stereotype allows for auto-detection, aligned with Spring general support
for detecting <code>@Component</code> classes in the classpath and auto-registering bean definitions
for them. It also acts as a stereotype for the annotated class, indicating its role as
a web component.</p>
</div>
<div class="paragraph">
<p>To enable auto-detection of such <code>@Controller</code> beans, you can add component scanning to
your Java configuration:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@ComponentScan("org.example.web")
public class WebConfig {

	// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>@RestController</code> is a composed annotation that is itself annotated with
<code>@Controller</code> and <code>@ResponseBody</code> indicating a controller whose every method inherits the type-level
<code>@ResponseBody</code> annotation and therefore writes to the response body (vs model-and-vew
rendering).</p>
</div>
</div>
<div class="sect2">
<h3 id="webflux-ann-requestmapping">Request Mapping</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-requestmapping">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>The <code>@RequestMapping</code> annotation is used to map requests to controllers methods. It has
various attributes to match by URL, HTTP method, request parameters, headers, and media
types. It can be used at the class-level to express shared mappings or at the method level
to narrow down to a specific endpoint mapping.</p>
</div>
<div class="paragraph">
<p>There are also HTTP method specific shortcut variants of <code>@RequestMapping</code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>@GetMapping</code></p>
</li>
<li>
<p><code>@PostMapping</code></p>
</li>
<li>
<p><code>@PutMapping</code></p>
</li>
<li>
<p><code>@DeleteMapping</code></p>
</li>
<li>
<p><code>@PatchMapping</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The shortcut variants are
<a href="https://github.com/spring-projects/spring-framework/wiki/Spring-Annotation-Programming-Model#composed-annotations">composed annotations</a>&#8201;&#8212;&#8201;themselves annotated with <code>@RequestMapping</code>. They are commonly used at the method level.
At the class level an <code>@RequestMapping</code> is more useful for expressing shared mappings.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@RestController
@RequestMapping("/persons")
class PersonController {

	@GetMapping("/{id}")
	public Person getPerson(@PathVariable Long id) {
		// ...
	}

	@PostMapping
	@ResponseStatus(HttpStatus.CREATED)
	public void add(@RequestBody Person person) {
		// ...
	}
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="webflux-ann-requestmapping-uri-templates">URI Patterns</h4>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-requestmapping-uri-templates">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>You can map requests using glob patterns and wildcards:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>?</code> matches one character</p>
</li>
<li>
<p><code>*</code> matches zero or more characters within a path segment</p>
</li>
<li>
<p><code>**</code> match zero or more path segments</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also declare URI variables and access their values with <code>@PathVariable</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@GetMapping("/owners/{ownerId}/pets/{petId}")
public Pet findPet(@PathVariable Long ownerId, @PathVariable Long petId) {
	// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>URI variables can be declared at the class and method level:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
@RequestMapping("/owners/{ownerId}")
public class OwnerController {

	@GetMapping("/pets/{petId}")
	public Pet findPet(@PathVariable Long ownerId, @PathVariable Long petId) {
		// ...
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>URI variables are automatically converted to the appropriate type or`TypeMismatchException`
is raised. Simple types&#8201;&#8212;&#8201;<code>int</code>, <code>long</code>, <code>Date</code>, are supported by default and you can
register support for any other data type.</p>
</div>
<div class="paragraph">
<p>URI variables can be named explicitly&#8201;&#8212;&#8201;e.g. <code>@PathVariable("customId")</code>, but you can
leave that detail out if the names are the same and your code is compiled with debugging
information or with the <code>-parameters</code> compiler flag on Java 8.</p>
</div>
<div class="paragraph">
<p>The syntax <code>{*varName}</code> declares a URI variable that matches zero or more remaining
path segments. For example <code>/resources/{*path}</code> matches all files <code>/resources/</code> and the
<code>"path"</code> variable captures the complete relative path.</p>
</div>
<div class="paragraph">
<p>The syntax <code>{varName:regex}</code> declares a URI variable with a regular expressions with the
syntax <code>{varName:regex}</code>&#8201;&#8212;&#8201;e.g. given URL <code>"/spring-web-3.0.5 .jar"</code>, the below method
extracts the name, version, and file extension:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@GetMapping("/{name:[a-z-]+}-{version:\\d\\.\\d\\.\\d}{ext:\\.[a-z]+}")
public void handle(@PathVariable String version, @PathVariable String ext) {
	// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>URI path patterns can also have embedded <code>${&#8230;&#8203;}</code> placeholders that are resolved on startup
 via <code>PropertyPlaceHolderConfigurer</code> against local, system, environment, and other property
sources. This can be used for example to parameterize a base URL based on some external
configuration.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>Spring WebFlux uses <code>PathPattern</code> and the <code>PathPatternParser</code> for URI path matching support
both of which are located in <code>spring-web</code> and expressly designed for use with HTTP URL
paths in web applications where a large number of URI path patterns are matched at runtime.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Spring WebFlux does not support suffix pattern matching&#8201;&#8212;&#8201;unlike Spring MVC, where a
mapping such as <code>/person</code> also matches to <code>/person.*</code>. For URL based content
negotiation, if needed, we recommend using a query parameter, which is simpler, more
explicit, and less vulnerable to URL path based exploits.</p>
</div>
</div>
<div class="sect3">
<h4 id="webflux-ann-requestmapping-pattern-comparison">Pattern Comparison</h4>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-requestmapping-pattern-comparison">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>When multiple patterns match a URL, they must be compared to find the best match. This is done
with <code>PathPattern.SPECIFICITY_COMPARATOR</code> which looks for patterns that more specific.</p>
</div>
<div class="paragraph">
<p>For every pattern, a score is computed based the number of URI variables and wildcards
where a URI variable scores lower than a wildcard. A pattern with a lower total score
wins. If two patterns have the same score, then the longer is chosen.</p>
</div>
<div class="paragraph">
<p>Catch-all patterns, e.g. <code>**</code>, <code>{*varName}</code>, are excluded from the scoring and are always
sorted last instead. If two patterns are both catch-all, the longer is chosen.</p>
</div>
</div>
<div class="sect3">
<h4 id="webflux-ann-requestmapping-consumes">Consumable Media Types</h4>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-requestmapping-consumes">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>You can narrow the request mapping based on the <code>Content-Type</code> of the request:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@PostMapping(path = "/pets", <strong>consumes = "application/json"</strong>)
public void addPet(@RequestBody Pet pet) {
	// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The consumes attribute also supports negation expressions&#8201;&#8212;&#8201;e.g. <code>!text/plain</code> means any
content type other than "text/plain".</p>
</div>
<div class="paragraph">
<p>You can declare a shared consumes attribute at the class level. Unlike most other request
mapping attributes however when used at the class level, a method-level consumes attribute
will overrides rather than extend the class level declaration.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p><code>MediaType</code> provides constants for commonly used media types&#8201;&#8212;&#8201;e.g.
<code>APPLICATION_JSON_VALUE</code>, <code>APPLICATION_JSON_UTF8_VALUE</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="webflux-ann-requestmapping-produces">Producible Media Types</h4>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-requestmapping-produces">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>You can narrow the request mapping based on the <code>Accept</code> request header and the list of
content types that a controller method produces:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@GetMapping(path = "/pets/{petId}", <strong>produces = "application/json;charset=UTF-8"</strong>)
@ResponseBody
public Pet getPet(@PathVariable String petId) {
	// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The media type can specify a character set. Negated expressions are supported&#8201;&#8212;&#8201;e.g.
<code>!text/plain</code> means any content type other than "text/plain".</p>
</div>
<div class="paragraph">
<p>You can declare a shared produces attribute at the class level. Unlike most other request
mapping attributes however when used at the class level, a method-level produces attribute
will overrides rather than extend the class level declaration.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p><code>MediaType</code> provides constants for commonly used media types&#8201;&#8212;&#8201;e.g.
<code>APPLICATION_JSON_VALUE</code>, <code>APPLICATION_JSON_UTF8_VALUE</code>.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="webflux-ann-requestmapping-params-and-headers">Parameters and Headers</h4>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-requestmapping-params-and-headers">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>You can narrow request mappings based on query parameter conditions. You can test for the
presence of a query parameter (<code>"myParam"</code>), for the absence (<code>"!myParam"</code>), or for a
specific value (<code>"myParam=myValue"</code>):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@GetMapping(path = "/pets/{petId}", <strong>params = "myParam=myValue"</strong>)
public void findPet(@PathVariable String petId) {
	// ...
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also use the same with request header conditions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@GetMapping(path = "/pets", <strong>headers = "myHeader=myValue"</strong>)
public void findPet(@PathVariable String petId) {
	// ...
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="webflux-ann-requestmapping-head-options">HTTP HEAD, OPTIONS</h4>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-requestmapping-head-options">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p><code>@GetMapping</code>&#8201;&#8212;&#8201;and also <code>@RequestMapping(method=HttpMethod.GET)</code>, support HTTP HEAD
transparently for request mapping purposes. Controller methods don&#8217;t need to change.
A response wrapper, applied in the <code>HttpHandler</code> server adapter, ensures a <code>"Content-Length"</code>
header is set to the number of bytes written and without actually writing to the response.</p>
</div>
<div class="paragraph">
<p>By default HTTP OPTIONS is handled by setting the "Allow" response header to the list of HTTP
methods listed in all <code>@RequestMapping</code> methods with matching URL patterns.</p>
</div>
<div class="paragraph">
<p>For a <code>@RequestMapping</code> without HTTP method declarations, the "Allow" header is set to
<code>"GET,HEAD,POST,PUT,PATCH,DELETE,OPTIONS"</code>. Controller methods should always declare the
supported HTTP methods for example by using the HTTP method specific variants&#8201;&#8212;&#8201;<code>@GetMapping</code>, <code>@PostMapping</code>, etc.</p>
</div>
<div class="paragraph">
<p><code>@RequestMapping</code> method can be explicitly mapped to HTTP HEAD and HTTP OPTIONS, but that
is not necessary in the common case.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="webflux-ann-methods">Handler methods</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-methods">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p><code>@RequestMapping</code> handler methods have a flexible signature and can choose from a range of
supported controller method arguments and return values.</p>
</div>
<div class="sect3">
<h4 id="webflux-ann-arguments">Method arguments</h4>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-arguments">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>The table below shows supported controller method arguments.</p>
</div>
<div class="paragraph">
<p>Reactive types (Reactor, RxJava, <a href="#webflux-reactive-libraries">or other</a>) are
supported on arguments that require blocking I/O, e.g. reading the request body, to
be resolved. This is marked in the description column. Reactive types are not expected
on arguments that don&#8217;t require blocking.</p>
</div>
<div class="paragraph">
<p>JDK 1.8&#8217;s <code>java.util.Optional</code> is supported as a method argument in combination with
annotations that have a <code>required</code> attribute&#8201;&#8212;&#8201;e.g. <code>@RequestParam</code>, <code>@RequestHeader</code>,
etc, and is equivalent to <code>required=false</code>.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Controller method argument</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServerWebExchange</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access to the full <code>ServerWebExchange</code>&#8201;&#8212;&#8201;container for the HTTP request and response,
request and session attributes, <code>checkNotModified</code> methods, and others.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServerHttpRequest</code>, <code>ServerHttpResponse</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access to the HTTP request or response.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WebSession</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Access to the session; this does not forcing the start of a new session unless attributes
are added. Supports reactive types.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.security.Principal</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Currently authenticated user; possibly a specific <code>Principal</code> implementation class if known.
Supports reactive types.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.springframework.http.HttpMethod</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The HTTP method of the request.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Locale</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The current request locale, determined by the most specific <code>LocaleResolver</code> available, in
 effect, the configured <code>LocaleResolver</code>/<code>LocaleContextResolver</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Java 6+: <code>java.util.TimeZone</code><br>
Java 8+: <code>java.time.ZoneId</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The time zone associated with the current request, as determined by a <code>LocaleContextResolver</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@PathVariable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access to URI template variables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@MatrixVariable</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access to name-value pairs in URI path segments.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestParam</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access to Servlet request parameters. Parameter values are converted to the declared
method argument type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestHeader</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access to request headers. Header values are converted to the declared method argument
type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestBody</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access to the HTTP request body. Body content is converted to the declared method
argument type using <code>HttpMessageReader</code>'s. Supports reactive types.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpEntity&lt;B&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access to request headers and body. The body is converted with <code>HttpMessageReader</code>'s.
Supports reactive types.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestPart</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access to a part in  a "multipart/form-data" request. Supports reactive types.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Map</code>, <code>org.springframework.ui.Model</code>, <code>org.springframework.ui.ModelMap</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access and updates of the implicit model that is exposed to the web view.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command or form object (with optional <code>@ModelAttribute</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Command object whose properties to bind to request parameters&#8201;&#8212;&#8201;via setters or directly to
fields, with customizable type conversion, depending on <code>@InitBinder</code> methods and/or the
HandlerAdapter configuration (see the <code>webBindingInitializer</code> property on
<code>RequestMappingHandlerAdapter</code>).</p>
<p class="tableblock">Command objects along with their validation results are exposed as model attributes, by
default using the command class name - e.g. model attribute "orderAddress" for a command
object of type "some.package.OrderAddress". <code>@ModelAttribute</code> can be used to customize the
model attribute name.</p>
<p class="tableblock">Supports reactive types.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Errors</code>, <code>BindingResult</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Validation results for the command/form object data binding; this argument must be
declared immediately after the command/form object in the controller method signature.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>SessionStatus</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For marking form processing complete which triggers cleanup of session attributes
declared through a class-level <code>@SessionAttributes</code> annotation.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>UriComponentsBuilder</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For preparing a URL relative to the current request&#8217;s host, port, scheme, context path, and
the literal  part of the servlet mapping also taking into account <code>Forwarded</code> and
<code>X-Forwarded-*</code> headers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@SessionAttribute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access to any session attribute; in contrast to model attributes stored in the session
as a result of a class-level <code>@SessionAttributes</code> declaration.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@RequestAttribute</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For access to request attributes.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="webflux-ann-return-types">Return values</h4>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-ann-return-types">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>The table below shows supported controller method return values. Reactive types&#8201;&#8212;&#8201;Reactor, RxJava, <a href="#webflux-reactive-libraries">or other</a> are supported for all return
values.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 66.6667%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Controller method return value</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ResponseBody</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The return value is encoded through <code>HttpMessageWriter</code>s and written to the response.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpEntity&lt;B&gt;</code>, <code>ResponseEntity&lt;B&gt;</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The return value specifies the full response including HTTP headers and body be encoded
through <code>HttpMessageWriter</code>s and written to the response.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>HttpHeaders</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">For returning a response with headers and no body.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>String</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A view name to be resolved with <code>ViewResolver</code>'s and used together with the implicit
model&#8201;&#8212;&#8201;determined through command objects and <code>@ModelAttribute</code> methods. The handler
method may also programmatically enrich the model by declaring a <code>Model</code> argument (see
above).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>View</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A <code>View</code> instance to use for rendering together with the implicit model&#8201;&#8212;&#8201;determined
through command objects and <code>@ModelAttribute</code> methods. The handler method may also
programmatically enrich the model by declaring a <code>Model</code> argument (see above).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>java.util.Map</code>, <code>org.springframework.ui.Model</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Attributes to be added to the implicit model with the view name implicitly determined
from the request path.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Rendering</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An API for model and view rendering scenarios.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>void</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A method with a <code>void</code>, possibly async (e.g. <code>Mono&lt;Void&gt;</code>), return type (or a <code>null</code> return
value) is considered to have fully handled the response if it also has a <code>ServerHttpResponse</code>,
or a <code>ServerWebExchange</code> argument, or an <code>@ResponseStatus</code> annotation. The same is true also
if the controller has made a positive ETag or lastModified timestamp check.</p>
<p class="tableblock">If none of the above is true, a <code>void</code> return type may also indicate "no response body" for
REST controllers, or default view name selection for HTML controllers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Flux&lt;ServerSentEvent&gt;</code>, <code>Observable&lt;ServerSentEvent&gt;</code>, or other reactive type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Emit server-sent events; the <code>SeverSentEvent</code> wrapper can be omitted when only data needs
to be written (however <code>text/event-stream</code> must be requested or declared in the mapping
through the produces attribute).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Any other return type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A single model attribute to be added to the implicit model with the view name implicitly
determined through a <code>RequestToViewNameTranslator</code>; the attribute name may be specified
through a method-level <code>@ModelAttribute</code> or otherwise a name is selected based on the
class name of the return type.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Unresolved directive in &lt;stdin&gt; - include::webflux-functional.adoc[leveloffset=+1]</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webflux-config">WebFlux Java Config</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>The WebFlux Java config provides default configuration suitable for most applications along
with a configuration API to customize it. For more advanced customizations, not available in
the configuration API, see <a href="#webflux-config-advanced-java">Advanced config mode</a>.</p>
</div>
<div class="paragraph">
<p>You do not need to understand the underlying beans created by the Java config, but it&#8217;s
easy to seem them in <code>WebFluxConfigurationSupport</code>, and if you want to learn more, see
<a href="#webflux-special-bean-types">Special bean types</a>.</p>
</div>
<div class="sect2">
<h3 id="webflux-config-enable">Enable WebFlux config</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-enable">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>Use the <code>@EnableWebFlux</code> annotation in your Java config:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig {
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The above registers a number of Spring WebFlux
<a href="#mvc-webflux-special-bean-types">infrastructure beans</a> also adapting to dependencies
available on the classpath&#8201;&#8212;&#8201;for JSON, XML, etc.</p>
</div>
</div>
<div class="sect2">
<h3 id="webflux-config-customize">WebFlux config API</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-customize">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>In your Java config implement the <code>WebFluxConfigurer</code> interface:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	// Implement configuration methods...

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="webflux-config-conversion">Conversion, formatting</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-conversion">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>By default formatters for <code>Number</code> and <code>Date</code> types are installed, including support for
the <code>@NumberFormat</code> and <code>@DateTimeFormat</code> annotations. Full support for the Joda Time
formatting library is also installed if Joda Time is present on the classpath.</p>
</div>
<div class="paragraph">
<p>To register custom formatters and converters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	@Override
	public void addFormatters(FormatterRegistry registry) {
		// ...
	}

}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph">
<p>See <a href="core.html#format-FormatterRegistrar-SPI">FormatterRegistrar SPI</a>
and the <code>FormattingConversionServiceFactoryBean</code> for more information on when to use FormatterRegistrars.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="webflux-config-validation">Validation</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-validation">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>By default if <a href="core.html#validation-beanvalidation-overview">Bean Validation</a> is present
on the classpath&#8201;&#8212;&#8201;e.g. Hibernate Validator, the <code>LocalValidatorFactoryBean</code> is registered
as a global <a href="core.html#validator">Validator</a> for use with <code>@Valid</code> and <code>Validated</code> on
<code>@Controller</code> method arguments.</p>
</div>
<div class="paragraph">
<p>In your Java config, you can customize the global <code>Validator</code> instance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	@Override
	public Validator getValidator(); {
		// ...
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that you can also register <code>Validator</code>'s locally:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Controller
public class MyController {

	@InitBinder
	protected void initBinder(WebDataBinder binder) {
		binder.addValidators(new FooValidator());
	}

}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph">
<p>If you need to have a <code>LocalValidatorFactoryBean</code> injected somewhere, create a bean and
mark it with <code>@Primary</code> in order to avoid conflict with the one declared in the MVC config.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="webflux-config-content-negotiation">Content type resolvers</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-content-negotiation">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>You can configure how Spring WebFlux determines the requested media types for
<code>@Controller</code>'s from the request. By default only the "Accept" header is checked but you
can also enable a query parameter based strategy.</p>
</div>
<div class="paragraph">
<p>To customize the requested content type resolution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	@Override
	public void configureContentTypeResolver(RequestedContentTypeResolverBuilder builder) {
		// ...
	}
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="webflux-config-message-codecs">HTTP message codecs</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-message-converters">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>To customize how the request and response body are read and written:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	@Override
	public void configureHttpMessageCodecs(ServerCodecConfigurer configurer) {
		// ...
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>ServerCodecConfigurer</code> provides a set of default readers and writers. You can use it to add
more readers and writers, customize the default ones, or replace the default ones completely.</p>
</div>
<div class="paragraph">
<p>For Jackson JSON and XML, consider using the
{api-spring-framework}/http/converter/json/Jackson2ObjectMapperBuilder.html[Jackson2ObjectMapperBuilder]
which customizes Jackson&#8217;s default properties with the following ones:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="http://fasterxml.github.io/jackson-databind/javadoc/2.6/com/fasterxml/jackson/databind/DeserializationFeature.html#FAIL_ON_UNKNOWN_PROPERTIES"><code>DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES</code></a> is disabled.</p>
</li>
<li>
<p><a href="http://fasterxml.github.io/jackson-databind/javadoc/2.6/com/fasterxml/jackson/databind/MapperFeature.html#DEFAULT_VIEW_INCLUSION"><code>MapperFeature.DEFAULT_VIEW_INCLUSION</code></a> is disabled.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It also automatically registers the following well-known modules if they are detected on the classpath:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="https://github.com/FasterXML/jackson-datatype-jdk7">jackson-datatype-jdk7</a>: support for Java 7 types like <code>java.nio.file.Path</code>.</p>
</li>
<li>
<p><a href="https://github.com/FasterXML/jackson-datatype-joda">jackson-datatype-joda</a>: support for Joda-Time types.</p>
</li>
<li>
<p><a href="https://github.com/FasterXML/jackson-datatype-jsr310">jackson-datatype-jsr310</a>: support for Java 8 Date &amp; Time API types.</p>
</li>
<li>
<p><a href="https://github.com/FasterXML/jackson-datatype-jdk8">jackson-datatype-jdk8</a>: support for other Java 8 types like <code>Optional</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="webflux-config-view-resolvers">View resolvers</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-view-resolvers">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>To configure view resolution:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	@Override
	public void configureViewResolvers(ViewResolverRegistry registry) {
		// ...
	}
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that FreeMarker also requires configuration of the underlying view technology:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	// ...

	@Bean
	public FreeMarkerConfigurer freeMarkerConfigurer() {
		FreeMarkerConfigurer configurer = new FreeMarkerConfigurer();
		configurer.setTemplateLoaderPath("classpath:/templates");
		return configurer;
	}

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="webflux-config-static-resources">Static resources</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-static-resources">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>This option provides a convenient way to serve static resources from a list of
{api-spring-framework}/core/io/Resource.html[Resource]-based locations.</p>
</div>
<div class="paragraph">
<p>In the example below, given a request that starts with <code>"/resources"</code>, the relative path is
used to find and serve static resources relative to <code>"/static"</code> on the classpath. Resources
will be served with a 1-year future expiration to ensure maximum use of the browser cache
and a reduction in HTTP requests made by the browser. The <code>Last-Modified</code> header is also
evaluated and if present a <code>304</code> status code is returned.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	@Override
	public void addResourceHandlers(ResourceHandlerRegistry registry) {
		registry.addResourceHandler("/resources/**")
			.addResourceLocations("/public", "classpath:/static/")
			.setCachePeriod(31556926);
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The resource handler also supports a chain of
{api-spring-framework}/web/reactive/resource/ResourceResolver.html[ResourceResolver]'s and
{api-spring-framework}/web/reactive/resource/ResourceTransformer.html[ResourceTransformer]'s.
which can be used to create a toolchain for working with optimized resources.</p>
</div>
<div class="paragraph">
<p>The <code>VersionResourceResolver</code> can be used for versioned resource URLs based on an MD5 hash
computed from the content, a fixed application version, or other. A
<code>ContentVersionStrategy</code> (MD5 hash) is a good choice with some notable exceptions such as
JavaScript resources used with a module loader.</p>
</div>
<div class="paragraph">
<p>For example in your Java config;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	@Override
	public void addResourceHandlers(ResourceHandlerRegistry registry) {
		registry.addResourceHandler("/resources/**")
				.addResourceLocations("/public/")
				.resourceChain(true)
				.addResolver(new VersionResourceResolver().addContentVersionStrategy("/**"));
	}

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use <code>ResourceUrlProvider</code> to rewrite URLs and apply the full chain of resolvers and
transformers&#8201;&#8212;&#8201;e.g. to insert versions. The WebFlux config provides a <code>ResourceUrlProvider</code>
so it can be injected into others.</p>
</div>
<div class="paragraph">
<p>Unlike Spring MVC at present in WebFlux there is no way to transparely rewrite static
resource URLs since the are no view technologies that can make use of a non-blocking chain
of resolvers and transformers (e.g. resources on Amazon S3). When serving only local
resources the workaround is to use <code>ResourceUrlProvider</code> directly (e.g. through a custom
tag) and block for 0 seconds.</p>
</div>
<div class="paragraph">
<p><a href="http://www.webjars.org/documentation">WebJars</a> is also supported via <code>WebJarsResourceResolver</code>
and automatically registered when <code>"org.webjars:webjars-locator"</code> is present on the
classpath. The resolver can re-write URLs to include the version of the jar and can also
match to incoming URLs without versions&#8201;&#8212;&#8201;e.g. <code>"/jquery/jquery.min.js"</code> to
<code>"/jquery/1.2.0/jquery.min.js"</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="webflux-config-path-matching">Path Matching</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-path-matching">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>Spring WebFlux uses parsed representation of path patterns&#8201;&#8212;&#8201;i.e. <code>PathPattern</code>, and also
the incoming  request path&#8201;&#8212;&#8201;i.e. <code>RequestPath</code>, which eliminates the need to indicate
whether to decode the request path, or remove semicolon content, since <code>PathPattern</code>
can now access decoded path segment values and match safely.</p>
</div>
<div class="paragraph">
<p>Spring WebFlux also does not support suffix pattern matching so effectively there are only two
minor options to customize related to path matching&#8201;&#8212;&#8201;whether to match trailing slashes
(<code>true</code> by default) and whether the match is case-sensitive (<code>false</code>).</p>
</div>
<div class="paragraph">
<p>To customize those options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
@EnableWebFlux
public class WebConfig implements WebFluxConfigurer {

	@Override
	public void configurePathMatch(PathMatchConfigurer configurer) {
		// ...
	}

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="webflux-config-advanced-java">Advanced config mode</h3>
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-config-advanced-java">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p><code>@EnableWebFlux</code> imports <code>DelegatingWebFluxConfiguration</code> that (1) provides default
Spring configuration for WebFlux applications and (2) detects and delegates to
<code>WebFluxConfigurer</code>'s to customize that configuration.</p>
</div>
<div class="paragraph">
<p>For advanced mode, remove <code>@EnableWebFlux</code> and extend directly from
<code>DelegatingWebFluxConfiguration</code> instead of implementing <code>WebFluxConfigurer</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">@Configuration
public class WebConfig extends DelegatingWebFluxConfiguration {

	// ...

}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can keep existing methods in <code>WebConfig</code> but you can now also override bean declarations
from the base class and you can still have any number of other <code>WebMvcConfigurer</code>'s on
the classpath.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="webflux-http2">HTTP/2</h2>
<div class="sectionbody">
<div class="paragraph">
<p><span class="small"><a href="web.html#mvc-http2">Same in Spring MVC</a></span></p>
</div>
<div class="paragraph">
<p>Servlet 4 containers are required to support HTTP/2 and Spring Framework 5 is compatible
with Servlet API 4. From a programming model perspective there is nothing specific that
applications need to do. However there are considerations related to server configuration.
For more details please check out the
<a href="https://github.com/spring-projects/spring-framework/wiki/HTTP-2-support">HTTP/2 wiki page</a>.</p>
</div>
<div class="paragraph">
<p>Currently Spring WebFlux does not support HTTP/2 with Netty. There is also no support for
pushing resources programmatically to the client.</p>
</div>
</div>
</div>
</div>

  <footer class="article-footer">

    <aside class="share">
  <a href="http://b.hatena.ne.jp/add?mode=confirm&url=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f&title=Spring%20WebFlux" title="はてなブックマーク" class="ht" target="_blank" rel="nofollow">B!</a>
  <a href="http://twitter.com/intent/tweet?url=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f&text=Spring%20WebFlux&tw_p=tweetbutton" title="Twitterでシェア" class="tw" target="_blank" rel="nofollow"><i class="fa fa-twitter" aria-hidden="true"></i></a>
  <a href="http://www.facebook.com/sharer.php?u=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f&t=Spring%20WebFlux" title="Facebookでシェア" class="fb" target="_blank" rel="nofollow"><i class="fa fa-facebook" aria-hidden="true"></i></a>
  <a href="https://plus.google.com/share?url=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f" title="Google Plusでシェア" class="gp" target="_blank" rel="nofollow"><i class="fa fa-google-plus" aria-hidden="true"></i></a>
  <a href="http://getpocket.com/edit?url=http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f&title=Spring%20WebFlux" title="Pocketに保存" class="pk" target="_blank" rel="nofollow"><i class="fa fa-get-pocket" aria-hidden="true"></i></a>
  <a href="http://line.me/R/msg/text/?Spring%20WebFlux http%3a%2f%2fdurtchrt.github.io%2fblog%2fenglish%2fspring.io%2fwebflux%2f" title="LINEでシェア" class="ln" target="_blank" rel="nofollow">LINE</a>
</aside>


    <section class="footer">
      <div>
        <nav class="crumb">
          <ol>
            <li><a href="http://durtchrt.github.io/blog/"><i class="fa fa-home" aria-hidden="true"></i>TOP</a></li>
            
            <li itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb"><a href="http://durtchrt.github.io/blog/english/" itemprop="url"><span itemprop="title">ENGLISH</span></a></li>
            
            <li class="active">Spring WebFlux</li>
          </ol>
        </nav>
      </div>
    </section>

    
    
    
    <section class="footer">
      <header>
        <a href="http://durtchrt.github.io/blog/categories/">CATEGORIES</a>
      </header>
      <div>
        <ul class="terms">
          
        </ul>
      </div>
    </section>
    
    
    
    <section class="footer">
      <header>
        <a href="http://durtchrt.github.io/blog/tags/">TAGS</a>
      </header>
      <div>
        <ul class="terms">
          
          <li><a href="http://durtchrt.github.io/blog/tags/spring/">spring</a></li>
          
          <li><a href="http://durtchrt.github.io/blog/tags/webflux/">webflux</a></li>
          
        </ul>
      </div>
    </section>
    
    
  </footer>

</article>


<div class="adj">
  <div class="mrow">
    
    
  </div>
</div>


      </div>
    </main>

    <footer class="l-footer">
      <div class="l-container">
        <p><span class="h-logo">&copy; durtchrt</span></p>
        <aside>
          <p>Powered by <a href="https://gohugo.io/">Hugo</a>.</p>
          <p><a href="https://github.com/dim0627/hugo_theme_robust">Robust</a> designed by <a href="http://yet.unresolved.xyz/">Daisuke Tsuji</a>.</p>
        </aside>
      </div>
    </footer>

  </body>
</html>

